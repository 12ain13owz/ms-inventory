<div class="d-flex flex-wrap align-center gap-10 mb-20">
  <a [routerLink]="['./qrcode']" mat-raised-button color="primary">
    ปริ้นคิวอาร์โค้ด
  </a>

  <a [routerLink]="['./barcode']" mat-raised-button color="primary">
    ปริ้นบาร์โค้ด
  </a>

  <a
    [routerLink]="['/parcel']"
    [queryParams]="{ isPrint: true }"
    mat-raised-button
    >เพิ่มพัสดุสำหรับปริ้น</a
  >
</div>

<mat-card>
  <mat-card-header class="mb-16 d-flex justify-between align-center">
    <mat-card-title>รายการปริ้นบาร์โค้ด</mat-card-title>
    <button type="button" mat-button color="warn" (click)="onReset()">
      Reset
    </button>
  </mat-card-header>

  <mat-card-content>
    <mat-table [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="image">
        <mat-header-cell *matHeaderCellDef mat-sort-header>รูป</mat-header-cell>
        <mat-cell *matCellDef="let element" style="padding-block: 8px">
          <a [routerLink]="['../parcel/view', element.id]" class="blurred-img">
            <img
              [defaultImage]="'assets/images/no-image.jpg'"
              [lazyLoad]="imageUrl + element.image"
            />
          </a>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="track">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >Track</mat-header-cell
        >
        <mat-cell *matCellDef="let element"> {{ element.track }} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="quantity">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >จำนวน</mat-header-cell
        >
        <mat-cell *matCellDef="let element"> {{ element.quantity }} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="printCount">
        <mat-header-cell *matHeaderCellDef mat-sort-header
          >จำนวนปริ้น</mat-header-cell
        >
        <mat-cell *matCellDef="let element" class="p-0">
          <div class="d-flex align-center">
            <button mat-icon-button (click)="incrementPrintCount(element.id)">
              <mat-icon color="accent">add</mat-icon>
            </button>

            <mat-form-field class="printCount-field">
              <input
                type="number"
                matInput
                [value]="element.printCount"
                (blur)="onBlurPrintCount($event, element.id)"
              />
            </mat-form-field>

            <button mat-icon-button (click)="decrementPrintCount(element.id)">
              <mat-icon color="accent">remove</mat-icon>
            </button>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="action">
        <mat-header-cell *matHeaderCellDef></mat-header-cell>
        <mat-cell *matCellDef="let element" class="p-0">
          <button mat-icon-button (click)="onDeleteParcel(element.id)">
            <mat-icon color="warn">close</mat-icon>
          </button>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
    </mat-table>
  </mat-card-content>

  <mat-paginator
    [pageSize]="50"
    [pageSizeOptions]="[10, 25, 50, 100]"
    showFirstLastButtons
  ></mat-paginator>
</mat-card>
